<div class="w-full relative"
  data-controller="item-select-all"
  data-resource-name="<%= @resource.model_key %>"
  data-item-select-all-selected-all-value="false"
  data-item-select-all-selected-query-value="<%= base64_query %>"
  data-selected-resources-name="<%= @resource.model_key %>"
  data-selected-resources="[]"
>
  <div id="selected_info" class="absolute z-30 w-full ml-10 mt-1 pt-px hidden" data-item-select-all-target="selectAllOvelay">
    <div class="bg-white">
      <div data-item-select-all-target="unselectedMessage">
        <span class="font-bold text-gray-700"><%= pagy.in %></span> selected from a total of <span class="font-bold text-gray-700"><%= pagy.count %></span>
        <%= helpers.a_link helpers.request.url,
          size: :xs,
          color: :primary,
          data: {action: "click->item-select-all#selectAll"},
          class: "cursor-pointer text-primary-500" do
        %>
          Select All
        <% end %>
        </div>
      <div data-item-select-all-target="selectedMessage" class="hidden">
        <span class="font-bold text-gray-700"><%= pagy.count %></span> selected from a total of <span class="font-bold text-gray-700"><%= pagy.count %></span>
        <%= link_to "Undo", helpers.request.url,
          class: "cursor-pointer text-primary-500",
          data: {action: "click->item-select-all#selectAll"}
        %>
      </div>
    </div>
  </div>
  <table class="w-full px-4 bg-white">
    <%= render partial: 'avo/partials/table_header', locals: {fields: @resource.get_fields(reflection: @reflection, only_root: true)} %>
    <tbody class="divide-y">
      <% @resources.each_with_index do |resource, index| %>
        <% cache_if Avo.configuration.cache_resources_on_index_view, resource.cache_hash(@parent_model), expires_in: 1.day do %>
          <%= render Avo::Index::TableRowComponent.new(resource: resource, reflection: @reflection, parent_model: @parent_model, parent_resource: @parent_resource) %>
        <% end %>
      <% end %>
    </tbody>
  </table>
</div>
